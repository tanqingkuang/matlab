
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>system_math_model</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-08-02"><meta name="DC.source" content="system_math_model.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">I &#22810;&#39033;&#24335;</a></li><li><a href="#5">II &#20256;&#36882;&#20989;&#25968;</a></li><li><a href="#9">III &#21709;&#24212;</a></li><li><a href="#14">IV &#29366;&#24577;&#31354;&#38388;&#27169;&#22411;</a></li></ul></div><pre class="codeinput">clear <span class="string">all</span>;clc;close <span class="string">all</span>;
</pre><h2>I &#22810;&#39033;&#24335;<a name="2"></a></h2><p>1. &#22810;&#39033;&#24335;&#19982;&#26681;</p><pre class="codeinput">p=[1 3 0 4];
r=roots(p) <span class="comment">% &#27714;&#35299;p(s)=0&#30340;&#26681;</span>
p=poly(r) <span class="comment">% &#26681;&#25454;p(s)=0&#30340;&#26681;&#21453;&#25512;&#22810;&#39033;&#24335;</span>
</pre><pre class="codeoutput">
r =

  -3.3553 + 0.0000i
   0.1777 + 1.0773i
   0.1777 - 1.0773i


p =

    1.0000    3.0000   -0.0000    4.0000

</pre><p>2. &#22810;&#39033;&#24335;&#30456;&#20056;</p><pre class="codeinput">p=[3 2 1];q=[1 4];
n=conv(p, q) <span class="comment">% &#22810;&#39033;&#24335;&#30456;&#20056;</span>
value = polyval(n,-5) <span class="comment">% &#22810;&#39033;&#24335;&#22312;-5&#26102;&#30340;&#20540;</span>
</pre><pre class="codeoutput">
n =

     3    14     9     4


value =

   -66

</pre><h2>II &#20256;&#36882;&#20989;&#25968;<a name="5"></a></h2><p>1.&#21019;&#24314;&#20256;&#36882;&#20989;&#25968;</p><pre class="codeinput">num1=[1 10]; den1=[1 2 1];
sys1=tf(num1, den1) <span class="comment">% &#21019;&#24314;&#20256;&#36882;&#20989;&#25968;</span>
</pre><pre class="codeoutput">
sys1 =
 
     s + 10
  -------------
  s^2 + 2 s + 1
 
Continuous-time transfer function.

</pre><p>2.&#20256;&#36882;&#20989;&#25968;&#36830;&#25509;</p><pre class="codeinput">num2=[1]; den2=[1 10];
sys2=tf(num2, den2);
sys_add = sys1 + sys2 <span class="comment">% &#20004;&#20010;&#20256;&#36882;&#20989;&#25968;&#27714;&#21644;&#65292;&#36824;&#26377;&#19968;&#31181;&#34920;&#31034;parallel(sys1, sys2)</span>
sys_mul = sys1 * sys2 <span class="comment">% &#20004;&#20010;&#20256;&#36882;&#20989;&#25968;&#30456;&#20056;&#65292;&#36824;&#26377;&#19968;&#31181;&#34920;&#31034;series(sys1, sys2)</span>
sys_fb = feedback(sys1, sys2, -1) <span class="comment">% sys2&#20316;&#20026;&#36127;&#21453;&#39304;</span>
sys_mul_real = minreal(sys_mul) <span class="comment">% &#28040;&#38500;&#20844;&#22240;&#24335;</span>
</pre><pre class="codeoutput">
sys_add =
 
     2 s^2 + 22 s + 101
  ------------------------
  s^3 + 12 s^2 + 21 s + 10
 
Continuous-time transfer function.


sys_mul =
 
           s + 10
  ------------------------
  s^3 + 12 s^2 + 21 s + 10
 
Continuous-time transfer function.


sys_fb =
 
      s^2 + 20 s + 100
  ------------------------
  s^3 + 12 s^2 + 22 s + 20
 
Continuous-time transfer function.


sys_mul_real =
 
        1
  -------------
  s^2 + 2 s + 1
 
Continuous-time transfer function.

</pre><p>3.&#38646;&#28857; &amp; &#26497;&#28857;</p><pre class="codeinput">p = pole(sys1) <span class="comment">% &#20256;&#36882;&#20989;&#25968;&#35745;&#31639;&#26497;&#28857;</span>
z = zero(sys1) <span class="comment">% &#20256;&#36882;&#20989;&#25968;&#35745;&#31639;&#38646;&#28857;</span>
<span class="comment">% &#20256;&#36882;&#20989;&#25968;&#21516;&#26102;&#35745;&#31639;&#26497;&#28857;&#21644;&#38646;&#28857;[p, z] = pzmap(sys1)</span>
</pre><pre class="codeoutput">
p =

    -1
    -1


z =

   -10

</pre><h2>III &#21709;&#24212;<a name="9"></a></h2><p>1. &#38454;&#36291;&#21709;&#24212;</p><pre class="codeinput">t=[0:0.01:8];
[y,t] = step(sys_fb, t); <span class="comment">% &#38454;&#36291;&#21709;&#24212;</span>
plot(t,y), grid
</pre><img vspace="5" hspace="5" src="system_math_model_01.png" alt=""> <p>2. &#33033;&#20914;&#21709;&#24212;</p><pre class="codeinput">t=[0:0.01:8];
[y,t] = impulse(sys_fb, t); <span class="comment">% &#33033;&#20914;&#21709;&#24212;</span>
plot(t,y), grid
</pre><img vspace="5" hspace="5" src="system_math_model_02.png" alt=""> <p>3. &#20219;&#24847;&#36755;&#20837;&#21709;&#24212;</p><pre class="codeinput">t=[0:0.1:20];
u=sin(t);
[y,T,x]=lsim(sys_fb,u,t,0); <span class="comment">% &#35745;&#31639;&#26576;&#20010;&#36755;&#20837;&#19979;&#30340;&#36755;&#20986;</span>
plot(T,y, t,u,<span class="string">'r'</span>), grid;
</pre><img vspace="5" hspace="5" src="system_math_model_03.png" alt=""> <p>4. &#20219;&#24847;&#21021;&#22987;&#20540; &amp; &#20219;&#24847;&#36755;&#20837;&#19979;&#30340;&#21709;&#24212;</p><pre class="codeinput">sys_ss=ss(sys_fb);
x0=[0 1 1]; <span class="comment">% &#30001;&#20110;sys_fb&#26159;3&#38454;&#27169;&#22411;&#65292;&#25152;&#20197;x&#26159;3*1&#21521;&#37327;</span>
t=[0:0.1:20];
u=sin(t);
<span class="comment">% &#35745;&#31639;&#26576;&#20010;&#21021;&#22987;&#29366;&#24577; &amp; &#36755;&#20837;&#19979;&#30340;&#36755;&#20986;, &#30001;&#20110;&#38656;&#35201;&#21021;&#22987;&#29366;&#24577;&#65292;&#25152;&#20197;&#24517;&#39035;&#20351;&#29992;&#29366;&#24577;&#31354;&#38388;&#27169;&#22411;&#65292;&#32780;&#19981;&#33021;&#20351;&#29992;&#20256;&#36882;&#20989;&#25968;</span>
[y,T,x]=lsim(sys_ss,u,t,x0);
subplot(221), plot(T,y, t,u,<span class="string">'r'</span>), legend(<span class="string">'y'</span>,<span class="string">'u'</span>), grid;
subplot(222), plot(T,x(:,1)), legend(<span class="string">'x0'</span>), grid;
subplot(223), plot(T,x(:,2)), legend(<span class="string">'x1'</span>), grid;
subplot(224), plot(T,x(:,3)), legend(<span class="string">'x2'</span>), grid;
</pre><img vspace="5" hspace="5" src="system_math_model_04.png" alt=""> <h2>IV &#29366;&#24577;&#31354;&#38388;&#27169;&#22411;<a name="14"></a></h2><p>1. &#20256;&#36882;&#20989;&#25968;&#21644;&#29366;&#24577;&#31354;&#38388;&#27169;&#22411;&#30456;&#20114;&#36716;&#25442;</p><pre class="codeinput">num = [2 8 6];den = [1 8 16 6];sys_tf=tf(num, den);
sys_ss=ss(sys_tf) <span class="comment">% &#36890;&#36807;&#20256;&#36882;&#20989;&#25968;&#35745;&#31639;&#29366;&#24577;&#31354;&#38388;&#27169;&#22411;</span>
</pre><pre class="codeoutput">
sys_ss =
 
  A = 
         x1    x2    x3
   x1    -8    -4  -1.5
   x2     4     0     0
   x3     0     1     0
 
  B = 
       u1
   x1   2
   x2   0
   x3   0
 
  C = 
         x1    x2    x3
   y1     1     1  0.75
 
  D = 
       u1
   y1   0
 
Continuous-time state-space model.

</pre><p>2. &#29366;&#24577;&#36716;&#31227;&#30697;&#38453;</p><pre class="codeinput">A=[0 -2; 1 -3]; dt=0.2;
Phi=expm(A*dt) <span class="comment">% 0.2&#26102;&#21051;&#30340;&#29366;&#24577;&#36716;&#31227;&#30697;&#38453;</span>
</pre><pre class="codeoutput">
Phi =

    0.9671   -0.2968
    0.1484    0.5219

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
clear all;clc;close all;

%% I 多项式
%%
% 1. 多项式与根
p=[1 3 0 4];
r=roots(p) % 求解p(s)=0的根
p=poly(r) % 根据p(s)=0的根反推多项式

%%
% 2. 多项式相乘
p=[3 2 1];q=[1 4];
n=conv(p, q) % 多项式相乘
value = polyval(n,-5) % 多项式在-5时的值

%% II 传递函数
%%
% 1.创建传递函数
num1=[1 10]; den1=[1 2 1];
sys1=tf(num1, den1) % 创建传递函数

%%
% 2.传递函数连接
num2=[1]; den2=[1 10];
sys2=tf(num2, den2);
sys_add = sys1 + sys2 % 两个传递函数求和，还有一种表示parallel(sys1, sys2)
sys_mul = sys1 * sys2 % 两个传递函数相乘，还有一种表示series(sys1, sys2)
sys_fb = feedback(sys1, sys2, -1) % sys2作为负反馈
sys_mul_real = minreal(sys_mul) % 消除公因式

%%
% 3.零点 & 极点
p = pole(sys1) % 传递函数计算极点
z = zero(sys1) % 传递函数计算零点
% 传递函数同时计算极点和零点[p, z] = pzmap(sys1)

%% III 响应
%%
% 1. 阶跃响应
t=[0:0.01:8];
[y,t] = step(sys_fb, t); % 阶跃响应
plot(t,y), grid

%%
% 2. 脉冲响应
t=[0:0.01:8];
[y,t] = impulse(sys_fb, t); % 脉冲响应
plot(t,y), grid

%%
% 3. 任意输入响应
t=[0:0.1:20];
u=sin(t);
[y,T,x]=lsim(sys_fb,u,t,0); % 计算某个输入下的输出
plot(T,y, t,u,'r'), grid;

%%
% 4. 任意初始值 & 任意输入下的响应
sys_ss=ss(sys_fb);
x0=[0 1 1]; % 由于sys_fb是3阶模型，所以x是3*1向量
t=[0:0.1:20];
u=sin(t);
% 计算某个初始状态 & 输入下的输出, 由于需要初始状态，所以必须使用状态空间模型，而不能使用传递函数
[y,T,x]=lsim(sys_ss,u,t,x0);
subplot(221), plot(T,y, t,u,'r'), legend('y','u'), grid;
subplot(222), plot(T,x(:,1)), legend('x0'), grid;
subplot(223), plot(T,x(:,2)), legend('x1'), grid;
subplot(224), plot(T,x(:,3)), legend('x2'), grid;

%% IV 状态空间模型
% 1. 传递函数和状态空间模型相互转换
num = [2 8 6];den = [1 8 16 6];sys_tf=tf(num, den);
sys_ss=ss(sys_tf) % 通过传递函数计算状态空间模型

%%
% 2. 状态转移矩阵
A=[0 -2; 1 -3]; dt=0.2;
Phi=expm(A*dt) % 0.2时刻的状态转移矩阵
##### SOURCE END #####
--></body></html>